TABLAS: EMPLE Y DEPART (RELACIÓN N-1)

WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO ( VA A SER UNA CONDICIÓN SIEMPRE) Y LUEGO AND...
FROM DEPART, EMPLE


1. APELLIDO, OFICIO Y LOCALIDAD DE LOS DEPARTAMENTOS DE AQUELLOS EMPLEADOS CUYO OFICIO SEA ANALISTA

SELECT APELLIDO, OFICIO, LOC
FROM EMPLE, DEPART
WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO 
AND OFICIO = 'ANALISTA';

APELLIDO   OFICIO     LOC
---------- ---------- --------------
FERNANDEZ  ANALISTA   MADRID
GIL        ANALISTA   MADRID


2. OBTÉN LOS DATOS DE LOS EMPLEADOS CUYOS DIRECTOR SEA "CEREZO"

2.1 buscamos a CEREZO PARA SABER SU ID, ETC...

SELECT *
FROM EMPLE
WHERE APELLIDO = 'CEREZO';

SELECT APELLIDO, OFICIO, DIR
FROM EMPLE
WHERE DIR = 7782;

APELLIDO   OFICIO            DIR
---------- ---------- ----------
MUÑOZ      EMPLEADO         7782

3. OBTÉN LOS DATOS DE LOS EMPLEADOS DEL DEPARTAMENTO DE "VENTAS"

SELECT APELLIDO, OFICIO, DIR, SALARIO, DNOMBRE
FROM DEPART, EMPLE
WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO 
AND
DNOMBRE = 'VENTAS';

APELLIDO   OFICIO            DIR    SALARIO DNOMBRE
---------- ---------- ---------- ---------- --------------
ARROYO     VENDEDOR         7698       1500 VENTAS
SALA       VENDEDOR         7698       1625 VENTAS
MARTIN     VENDEDOR         7698       1600 VENTAS
NEGRO      DIRECTOR         7839       3005 VENTAS
TOVAR      VENDEDOR         7698       1350 VENTAS
JIMENO     EMPLEADO         7698       1335 VENTAS


4. OBTÉN LOS DATOS DE LOS DEPARTAMENTOS QUE NO TENGAN EMPLEADOS 

SELECT DEPT_NO, DNOMBRE, LOC
FROM DEPART
WHERE (
    SELECT COUNT(*)
    FROM EMPLE
    WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO
) = 0;

TIENE SENTIDO HACERLO CON EL CONTADOR YA QUE CUENTA LA CANTIDAD DE EMPLEADOS QUE HAY EN EL DEPARTAMENTO 

   DEPT_NO DNOMBRE        LOC
---------- -------------- --------------
        40 PRODUCCION     BILBAO

ESTE ES EL ÚNICO DEPARTAMENTO CON 0 TRABAJADORES. 


5. OBTÉN LOS DATOS DE LOS DEPARTAMENTOS QUE TENGAN EMPLEADOS

(ES DECIR, AHORA PODEMOS USAR EL COUNT PARA MAYOR O IGUAL A 1, 1 EMPLEADO O MÁS . 

SELECT DEPT_NO , DNOMBRE, LOC 
FROM DEPART
WHERE(
SELECT COUNT(*)
    FROM EMPLE
    WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO
) >= 1;


ESTOS SON LOS DEPARTAMENTOS

   DEPT_NO DNOMBRE        LOC
---------- -------------- --------------
        10 CONTABILIDAD   SEVILLA
        20 INVESTIGACION  MADRID
        30 VENTAS         BARCELONA



6. OBTÉN EL APELLIDO Y EL SALARIO DE LOS EMPLEADOS QUE SUPEREN 
TODOS LOS SALARIOS DE LOS EMPLEADOS DEL DEPARTAMENTO 20. 

NO SÉ CÓMO HACERLO ---


TABLA LIBRERIA 

7. VISUALIZA EL TEMA, ESTANTE Y EJEMPLARES DE LAS FILAS DE LIBRERIA
CON EJEMPLARES COMPRENDIDOS ENTRE 8 Y 15. 

EJEMPLARES CONTENIDOS ENTRE 8 Y 15


SELECT TEMA, ESTANTE, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES BETWEEN 8 AND 15;


TEMA            E EJEMPLARES
--------------- - ----------
INFORMATICA     A         15
ECONOMIA        A         10
DEPORTES        B          8
DIBUJO          C         10
BIOLOGIA        A         11
SOCIEDAD        D          9



8. VISUALIZA LAS COLUMNAS TEMA, ESTANTE Y EJEMPLARES DE LAS FILAS CUYO ESTANTE NO ESTÉ COMPRENDIDO
ENTRE LA "B" Y LA "D". 


SELECT TEMA, ESTANTE, EJEMPLARES
FROM LIBRERIA
WHERE ESTANTE NOT BETWEEN 'B' AND 'D';


TEMA            E EJEMPLARES
--------------- - ----------
INFORMATICA     A         15
ECONOMIA        A         10
BIOLOGIA        A         11
JARDINERIA      E          6


9. VISUALIZA CON UNA SOLA ORDEN SELECT TODOS LOS TEMAS DE LIBRERIA CUYO NÚMERO DE EJEMPLARES SEA INFERIOR A 
LOS QUE HAY EN "MEDICINA". 

2 FORMAS 

INCORRECTA Y SENCILLA: 

PRIMERO INVESTIGAMOS LOS EJEMPLARES DE MEDICINA 

SELECT * 
FROM LIBRERIA
WHERE TEMA = 'MEDICINA';

TEMA            E EJEMPLARES
--------------- - ----------
MEDICINA        C         16

AHORA SABEMOS QUE TIENE 16 EJEMPLARES, ENTONCES...

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES < 16;

TEMA            EJEMPLARES
--------------- ----------
INFORMATICA             15
ECONOMIA                10
DEPORTES                 8
FILOSOFIA                7
DIBUJO                  10
BIOLOGIA                11
GEOLOGIA                 7
SOCIEDAD                 9
JARDINERIA               6


FORMA CORRECTA Y DIFÍCIL !!!!!!---


HARÍAMOS UNA CONSULTA MUY GRANDE CON LOS EJEMPLARES DE TODOS LOS TEMAS Y LUEGO 
HARÍAMOS UNA SUBCONSULTA QUE TOMARÍA LOS DATOS ÚNICAMENTE DE LOS EJEMPLARES CUYO TEMA SEA MEDICINA 
Y MOSTRARÍAMOS SÓLO AQUELLOS TEMAS QUE TENGAN MENOS EJEMPLARES QUE LA SEGUNDA CONSULTA
EN COMPARACIÓN A LA PRIMERA, ES DECIR MENOS EJEMPLARES QUE LA DE MEDICINA.

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES < (
    SELECT EJEMPLARES
    FROM LIBRERIA
    WHERE TEMA = 'MEDICINA'
);


TEMA            EJEMPLARES
--------------- ----------
INFORMATICA             15
ECONOMIA                10
DEPORTES                 8
FILOSOFIA                7
DIBUJO                  10
BIOLOGIA                11
GEOLOGIA                 7
SOCIEDAD                 9
JARDINERIA               6


10. VISUALIZA LOS TEMAS DE LIBRERIA CUYO NÚMERO DE EJEMPLARES NO ESTÁ ENTRE 15 Y 20, AMBOS INCLUIDOS 

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES NOT BETWEEN 15 AND 20;


















































 
 