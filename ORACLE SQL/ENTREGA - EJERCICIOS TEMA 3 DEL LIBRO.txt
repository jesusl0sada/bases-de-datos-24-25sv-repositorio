TABLAS: EMPLE Y DEPART (RELACIÓN N-1)

WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO ( VA A SER UNA CONDICIÓN SIEMPRE) Y LUEGO AND...
FROM DEPART, EMPLE


1. APELLIDO, OFICIO Y LOCALIDAD DE LOS DEPARTAMENTOS DE AQUELLOS EMPLEADOS CUYO OFICIO SEA ANALISTA

SELECT APELLIDO, OFICIO, LOC
FROM EMPLE, DEPART
WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO 
AND OFICIO = 'ANALISTA';

APELLIDO   OFICIO     LOC
---------- ---------- --------------
FERNANDEZ  ANALISTA   MADRID
GIL        ANALISTA   MADRID


2. OBTÉN LOS DATOS DE LOS EMPLEADOS CUYOS DIRECTOR SEA "CEREZO"

SELECT * 
FROM EMPLE 
WHERE DIR IN (SELECT EMP_NO
FROM EMPLE
WHERE UPPER(APELLIDO) = 'CEREZO');



    EMP_NO APELLIDO   OFICIO            DIR FECHA_ALT     SALARIO   COMISION
---------- ---------- ---------- ---------- ---------- ---------- ----------
   DEPT_NO
----------
      7934 MUÑOZ      EMPLEADO         7782 23/01/1992       1690
        10


3. OBTÉN LOS DATOS DE LOS EMPLEADOS DEL DEPARTAMENTO DE "VENTAS"

SELECT EMPLE.EMP_NO, EMPLE.APELLIDO, EMPLE.OFICIO, EMPLE.DEPT_NO
FROM EMPLE, DEPART
WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO 
AND UPPER(DEPART.DNOMBRE) = 'VENTAS';

    EMP_NO APELLIDO   OFICIO        DEPT_NO
---------- ---------- ---------- ----------
      7499 ARROYO     VENDEDOR           30
      7521 SALA       VENDEDOR           30
      7654 MARTIN     VENDEDOR           30
      7698 NEGRO      DIRECTOR           30
      7844 TOVAR      VENDEDOR           30
      7900 JIMENO     EMPLEADO           30

4. OBTÉN LOS DATOS DE LOS DEPARTAMENTOS QUE NO TENGAN EMPLEADOS 

SELECT DEPT_NO, DNOMBRE, LOC
FROM DEPART
WHERE (
    SELECT COUNT(APELLIDO)
    FROM EMPLE
    WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO
) = 0;

TIENE SENTIDO HACERLO CON EL CONTADOR YA QUE CUENTA LA CANTIDAD DE EMPLEADOS QUE HAY EN EL DEPARTAMENTO 

   DEPT_NO DNOMBRE        LOC
---------- -------------- --------------
        40 PRODUCCION     BILBAO

ESTE ES EL ÚNICO DEPARTAMENTO CON 0 TRABAJADORES. 


5. OBTÉN LOS DATOS DE LOS DEPARTAMENTOS QUE TENGAN EMPLEADOS

(ES DECIR, AHORA PODEMOS USAR EL COUNT PARA MAYOR O IGUAL A 1, 1 EMPLEADO O MÁS . 

SELECT DEPT_NO , DNOMBRE, LOC 
FROM DEPART
WHERE(
SELECT COUNT(APELLIDO)
    FROM EMPLE
    WHERE EMPLE.DEPT_NO = DEPART.DEPT_NO
) >= 1;


ESTOS SON LOS DEPARTAMENTOS

   DEPT_NO DNOMBRE        LOC
---------- -------------- --------------
        10 CONTABILIDAD   SEVILLA
        20 INVESTIGACION  MADRID
        30 VENTAS         BARCELONA



6. OBTÉN EL APELLIDO Y EL SALARIO DE LOS EMPLEADOS QUE SUPEREN 
TODOS LOS SALARIOS DE LOS EMPLEADOS DEL DEPARTAMENTO 20. 

SELECT APELLIDO, SALARIO, DEPART.DEPT_NO
FROM EMPLE, DEPART
WHERE DEPART.DEPT_NO = EMPLE.DEPT_NO
AND SALARIO > (
    SELECT MAX(SALARIO)
    FROM EMPLE
    WHERE DEPT_NO = 20
);


APELLIDO      SALARIO
---------- ----------
NEGRO            3005
REY              4100



TABLA LIBRERIA 

7. VISUALIZA EL TEMA, ESTANTE Y EJEMPLARES DE LAS FILAS DE LIBRERIA
CON EJEMPLARES COMPRENDIDOS ENTRE 8 Y 15. 

EJEMPLARES CONTENIDOS ENTRE 8 Y 15


SELECT TEMA, ESTANTE, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES BETWEEN 8 AND 15;


TEMA            E EJEMPLARES
--------------- - ----------
INFORMATICA     A         15
ECONOMIA        A         10
DEPORTES        B          8
DIBUJO          C         10
BIOLOGIA        A         11
SOCIEDAD        D          9



8. VISUALIZA LAS COLUMNAS TEMA, ESTANTE Y EJEMPLARES DE LAS FILAS CUYO ESTANTE NO ESTÉ COMPRENDIDO
ENTRE LA "B" Y LA "D". 


SELECT TEMA, ESTANTE, EJEMPLARES
FROM LIBRERIA
WHERE ESTANTE NOT BETWEEN 'B' AND 'D';


TEMA            E EJEMPLARES
--------------- - ----------
INFORMATICA     A         15
ECONOMIA        A         10
BIOLOGIA        A         11
JARDINERIA      E          6


9. VISUALIZA CON UNA SOLA ORDEN SELECT TODOS LOS TEMAS DE LIBRERIA CUYO NÚMERO DE EJEMPLARES SEA INFERIOR A 
LOS QUE HAY EN "MEDICINA". 

2 FORMAS 

INCORRECTA Y SENCILLA: 

PRIMERO INVESTIGAMOS LOS EJEMPLARES DE MEDICINA 

SELECT * 
FROM LIBRERIA
WHERE TEMA = 'MEDICINA';

TEMA            E EJEMPLARES
--------------- - ----------
MEDICINA        C         16

AHORA SABEMOS QUE TIENE 16 EJEMPLARES, ENTONCES...

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES < 16;

TEMA            EJEMPLARES
--------------- ----------
INFORMATICA             15
ECONOMIA                10
DEPORTES                 8
FILOSOFIA                7
DIBUJO                  10
BIOLOGIA                11
GEOLOGIA                 7
SOCIEDAD                 9
JARDINERIA               6


FORMA CORRECTA Y DIFÍCIL !!!!!!---


HARÍAMOS UNA CONSULTA MUY GRANDE CON LOS EJEMPLARES DE TODOS LOS TEMAS Y LUEGO 
HARÍAMOS UNA SUBCONSULTA QUE TOMARÍA LOS DATOS ÚNICAMENTE DE LOS EJEMPLARES CUYO TEMA SEA MEDICINA 
Y MOSTRARÍAMOS SÓLO AQUELLOS TEMAS QUE TENGAN MENOS EJEMPLARES QUE LA SEGUNDA CONSULTA
EN COMPARACIÓN A LA PRIMERA, ES DECIR MENOS EJEMPLARES QUE LA DE MEDICINA.

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES < (
    SELECT EJEMPLARES
    FROM LIBRERIA
    WHERE TEMA = 'MEDICINA'
);


TEMA            EJEMPLARES
--------------- ----------
INFORMATICA             15
ECONOMIA                10
DEPORTES                 8
FILOSOFIA                7
DIBUJO                  10
BIOLOGIA                11
GEOLOGIA                 7
SOCIEDAD                 9
JARDINERIA               6


10. VISUALIZA LOS TEMAS DE LIBRERIA CUYO NÚMERO DE EJEMPLARES NO ESTÁ ENTRE 15 Y 20, AMBOS INCLUIDOS 

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES NOT BETWEEN 15 AND 20;

TABLE NOTAS, ASIGNATURAS, ALUMNOS....

11. VISUALIZA TODAS LAS ASIGNATURAS QUE CONTENGAN TRES LETRAS "o" en su interior y tengan alumnos
matriculados de "Madrid".

SON DOS CONSULTAS PRINCIPAL Y SUBCONSULTA -> where name is like '%o%o%o%' y luego la subconsulta
de un count, mas de 0 alumnos; es decir al menos 1 es de Madrid. 

SELECT ASIGNATURAS.NOMBRE
FROM ASIGNATURAS
WHERE ASIGNATURAS.NOMBRE LIKE '%o%o%o%'
AND (
SELECT COUNT(*)
FROM ALUMNOS, NOTAS
WHERE NOTAS.DNI = ALUMNOS.DNI
AND ASIGNATURAS.COD = NOTAS.COD
AND ALUMNOS.POBLA = 'Madrid'
) > 0;


NOMBRE
-------------------------
Entornos Gráficos


12. VISUALIZA LOS NOMBRES DE ALUMNOS DE "MADRID" QUE TENGAN ALGUNA
ASIGNATURA SUSPENDIDA ( ES DECIR AL MENOS 1 )


VALE SON VARIAS CONSULTAS, UNA PRINCIPAL QUE TIENE VARIAS SUBCONSULTAS, PRINCIPALMENTE
DEBEMOS VER LOS NOMBRES DE LOS ALUMNOS DE MADRID , TIENEN AL MENOS UNA ASIGNATURA SUSPENDIDA; 
ESO QUIERE DECIR QUE EXISTE 1 ASIGNATURA CUYA NOTA ES MENOR DE 5, LO PODEMOS HACER CON UN ANY

SELECT ALUMNOS.DNI, ALUMNOS.APENOM, ALUMNOS.POBLA
FROM ALUMNOS, NOTAS
WHERE ALUMNOS.DNI = NOTAS.DNI 
AND NOTA IN (SELECT NOTA
FROM NOTAS
WHERE NOTA < 5)
AND UPPER(ALUMNOS.POBLA) = 'MADRID';


13. 

MUESTRA LOS NOMBRES DE ALUMNOS QUE TENGAN LA MISMA NOTA QUE TIENE
"DÍAZ FERNANDEZ, MARÍA" EN "FOL" EN ALGUNA ASIGNATURA. 

LA CONSULTA PRINCIPAL DEBERÍA SER EL NOMBRE PERO LO QUE VAMOS A 


SELECT DISTINCT ALUMNOS.APENOM
FROM ALUMNOS, NOTAS
WHERE NOTAS.NOTA = (
SELECT NOTAS.NOTA
FROM ALUMNOS, NOTAS, ASIGNATURAS
WHERE ALUMNOS.APENOM = 'Díaz Fernández, María'
AND ASIGNATURAS.NOMBRE = 'FOL'
AND ALUMNOS.DNI = NOTAS.DNI
AND NOTAS.COD = ASIGNATURAS.COD
);

APENOM
------------------------------
Alcalde García, Elena
Díaz Fernández, María
Cerrato Vela, Luis


SIN EL DISTINCT EN ESTE CASO SE HARÍA ASÍ PARA NO DISTINGUIR Y QUE SALIESEN PUDIESE
SALIR VARIAS VECES UN MISMO ALUMNO SI TIENE VARIAS VECES EN ESTE CASO LA NOTA QUE 
TIENE DÍAZ FERNÁNDEZ , MARÍA: 

SELECT ALUMNOS.APENOM
FROM ALUMNOS, NOTAS
WHERE NOTAS.NOTA = (
SELECT NOTAS.NOTA
FROM ALUMNOS, NOTAS, ASIGNATURAS
WHERE ALUMNOS.APENOM = 'Díaz Fernández, María'
AND ASIGNATURAS.NOMBRE = 'FOL'
AND ALUMNOS.DNI = NOTAS.DNI
AND NOTAS.COD = ASIGNATURAS.COD
);

APENOM
------------------------------
Alcalde García, Elena
Cerrato Vela, Luis
Díaz Fernández, María
Alcalde García, Elena
Cerrato Vela, Luis
Díaz Fernández, María
Alcalde García, Elena
Cerrato Vela, Luis
Díaz Fernández, María


14. OBTÉN LOS DATOS DE LAS ASIGNATURAS QUE NO TENGAN ALUMNOS

SELECT COD, NOMBRE
FROM ASIGNATURAS
WHERE COD NOT IN (
SELECT COD
FROM NOTAS
WHERE COD IS NOT NULL
);

       COD NOMBRE
---------- -------------------------
         8 Idioma


EJEMPLO DEL NOT IN:

Tabla ASIGNATURAS:

COD	NOMBRE
1	Matemáticas
2	Física
3	Química
4	Historia

Tabla NOTAS:

DNI	COD	NOTA
101	1	7
102	2	8

Química y Historia no tienen registros en NOTAS -> No tienen alumnos.

Es decir si el codigo de una asignatura no aparece en las notas quiere decir que no hay registros de esas asignaturas, es decir que no hay notas de esas asignaturas y por lo tanto si no hay notas no hay alumnos 


15. 

OBTÉN EL NOMBRE Y APELLIDO DE LOS ALUMNOS QUE TENGAN NOTA 
EN LA ASIGNATURA CON CÓDIGO 1. 


SELECT DISTINCT APENOM 
FROM ALUMNOS
WHERE ALUMNOS.DNI IN (
SELECT NOTAS.DNI 
FROM NOTAS
WHERE NOTAS.COD = 1
);


APENOM
------------------------------
Alcalde García, Elena


16. 

OBTÉN EL NOMBRE Y APELLIDO DE LOS ALUMNOS QUE 
NO TENGAN NOTA EN LA ASIGNATURA CON CÓDIGO 1. 

SELECT DISTINCT APENOM 
FROM ALUMNOS, NOTAS
WHERE ALUMNOS.DNI = NOTAS.DNI 
AND ALUMNOS.DNI NOT IN (
SELECT NOTAS.DNI 
FROM NOTAS
WHERE NOTAS.COD = 1);


APENOM
------------------------------
Cerrato Vela, Luis
Díaz Fernández, María







































 
 