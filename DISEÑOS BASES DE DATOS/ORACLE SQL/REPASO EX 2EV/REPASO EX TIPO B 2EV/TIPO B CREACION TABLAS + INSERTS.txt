
PLANTEAMIENTO E-R

1.CREACIÓN DE TABLAS: 

TABLAS: 
CLIENTE (1)
CLIENTE-VEHÍCULOS: FOREIGN KEYS DE CLIENTE Y DE VEHÍCULO (5)
VEHÍCULOS (2)
VEHÍCULOS - SERVICIOS:  FOREIGN KEYS DE VEHÍCULOS Y SERVICIO (6)
SERVICIOS (3)
PAGOS (4)



TABLA CLIENTE

CREATE TABLE CLIENTE(
DNI_CLIENTE VARCHAR2(14), 
NOMBRE_CLIENTE VARCHAR2(20),
APELLIDOS_CLIENTE VARCHAR2(20),
NUM_CUENTA_CLIENTE NUMBER(15),
TELEFONO_CLIENTE NUMBER(14),
DIRECCION_CLIENTE VARCHAR2(20),
CONSTRAINT PK_DNI_CLIENTE PRIMARY KEY (DNI_CLIENTE),
CONSTRAINT NN_NOMBRE_CLIENTE CHECK (NOMBRE_CLIENTE IS NOT NULL),
CONSTRAINT NN_APELLIDOS_CLIENTE CHECK (APELLIDOS_CLIENTE IS NOT NULL),
CONSTRAINT NN_NUM_CUENTA_CLIENTE CHECK (NUM_CUENTA_CLIENTE IS NOT NULL),
CONSTRAINT NN_DIRECCION_CLIENTE CHECK (DIRECCION_CLIENTE IS NOT NULL),
CONSTRAINT NN_TELEFONO_CLIENTE CHECK (TELEFONO_CLIENTE IS NOT NULL)
);



TABLA VEHÍCULOS -> SE CONECTA CON CLIENTES.

CREATE TABLE VEHICULOS(
ID_VEHICULO NUMBER(3), 
COLOR_VEHICULO VARCHAR2(12),
MATRICULA_VEHICULO VARCHAR2(7),
MODELO_VEHICULO VARCHAR2(20),
FECHA_MATRICULA DATE,
CONSTRAINT PK_ID_VEHICULO PRIMARY KEY (ID_VEHICULO),
CONSTRAINT NN_COLOR_VEHICULO CHECK (COLOR_VEHICULO IS NOT NULL),
CONSTRAINT NN_MATRICULA_VEHICULO CHECK (MATRICULA_VEHICULO IS NOT NULL),
CONSTRAINT NN_MODELO_VEHICULO CHECK (MODELO_VEHICULO IS NOT NULL),
CONSTRAINT NN_FECHA_MATRICULA CHECK (FECHA_MATRICULA IS NOT NULL)
);



TABLA SERVICIOS

CREATE TABLE SERVICIOS(
ID_SERVICIO NUMBER(3),
DESCRIPCION_SERVICIO VARCHAR2(15),
PRECIO_SERVICIO NUMBER(5),
CONSTRAINT PK_ID_SERVICIO PRIMARY KEY (ID_SERVICIO),
CONSTRAINT NN_DESCRIPCION_SERVICIO CHECK (DESCRIPCION_SERVICIO IS NOT NULL),
CONSTRAINT NN_PRECIO_SERVICIO CHECK (PRECIO_SERVICIO IS NOT NULL)
);



TABLA PAGOS

CREATE TABLE PAGOS(
ID_PAGO NUMBER(3),
ID_SERVICIO NUMBER(3),
MODO_PAGO VARCHAR2(13),
CONSTRAINT PK_ID_PAGO PRIMARY KEY (ID_PAGO),
CONSTRAINT FKK_ID_SERVICIO FOREIGN KEY (ID_SERVICIO) REFERENCES SERVICIOS (ID_SERVICIO),
CONSTRAINT NN_MODO_PAGO CHECK (MODO_PAGO IS NOT NULL)
);



TABLA CLIENTE_VEHICULOS -> TENDRÁ FOREIGN KEYS DE LAS DOS PRIMARY KEYS DE CADA TABLA: DNI_CLIENTE / ID_VEHICULO -> 

CREATE TABLE CLIENTE_VEHICULOS(
DNI_CLIENTE VARCHAR2(9),
ID_VEHICULO NUMBER(3),
FECHA_COMPRA DATE,
FECHA_VENTA DATE,
CONSTRAINT FK_DNI_CLIENTE FOREIGN KEY (DNI_CLIENTE) REFERENCES CLIENTE (DNI_CLIENTE),
CONSTRAINT FK_ID_VEHICULO FOREIGN KEY (ID_VEHICULO) REFERENCES VEHICULOS (ID_VEHICULO),
CONSTRAINT NN_FECHA_COMPRA CHECK (FECHA_COMPRA IS NOT NULL)
);


TABLA VEHICULOS-SERVICIOS -> TENDRÁ FK DE: ID_SERVICIO / ID_VEHICULO

CREATE TABLE VEHICULOS_SERVICIOS( 
ID_VEHICULO NUMBER(3),
ID_SERVICIO NUMBER(3),
CONSTRAINT FKK_ID_VEHICULO FOREIGN KEY (ID_VEHICULO) REFERENCES VEHICULOS (ID_VEHICULO),
CONSTRAINT FK_ID_SERVICIO FOREIGN KEY (ID_SERVICIO) REFERENCES SERVICIOS (ID_SERVICIO)
);


INSERTS (DATOS DE MUESTRA PARA METER INFORMACIÓN A LA TABLA) 


INSERT INTO CLIENTE VALUES ('12345678A', 'Juan', 'Gómez', 100001, '600112233', 'Calle Mayor 1');
INSERT INTO CLIENTE VALUES ('23456789B', 'María', 'Pérez', 100002, '600223344', 'Avenida Sol 2');
INSERT INTO CLIENTE VALUES ('34567890C', 'Carlos', 'López', 100003, '600334455', 'Paseo Luna 3');
INSERT INTO CLIENTE VALUES ('98765432D', 'Laura', 'Fernández', 100004, '600445566', 'Calle Sol 5');
INSERT INTO CLIENTE VALUES ('87654321E', 'Pedro', 'Martínez', 100005, '600556677', 'Calle Luna 6');



INSERT INTO VEHICULOS VALUES (1, 'Rojo', '1234ABC', 'Toyota Corolla', TO_DATE('2021-05-10', 'YYYY-MM-DD'));
INSERT INTO VEHICULOS VALUES (2, 'Azul', '5678DEF', 'Ford Fiesta', TO_DATE('2020-08-15', 'YYYY-MM-DD'));
INSERT INTO VEHICULOS VALUES (3, 'Negro', '9101GHI', 'BMW X3', TO_DATE('2019-10-20', 'YYYY-MM-DD'));
INSERT INTO VEHICULOS VALUES (4, 'Blanco', '2222JKL', 'Seat Ibiza', TO_DATE('2023-01-15', 'YYYY-MM-DD'));
INSERT INTO VEHICULOS VALUES (5, 'Gris', '3333MNO', 'Renault Clio', TO_DATE('2022-11-20', 'YYYY-MM-DD'));



INSERT INTO SERVICIOS VALUES (1, 'MANTENIMIENTO', 200);
INSERT INTO SERVICIOS VALUES (2, 'REPARACION', 150);
INSERT INTO SERVICIOS VALUES (3, 'ITV', 50);

INSERT INTO PAGOS VALUES (1, 1, 'Tarjeta');
INSERT INTO PAGOS VALUES (2, 2, 'Efectivo');
INSERT INTO PAGOS VALUES (3, 3, 'Transferencia');

INSERT INTO CLIENTE_VEHICULOS VALUES ('12345678A', 1, TO_DATE('2024-02-15', 'YYYY-MM-DD'), NULL);
INSERT INTO CLIENTE_VEHICULOS VALUES ('23456789B', 2, TO_DATE('2023-06-10', 'YYYY-MM-DD'), NULL);
INSERT INTO CLIENTE_VEHICULOS VALUES ('34567890C', 3, TO_DATE('2022-04-15', 'YYYY-MM-DD'), TO_DATE('2023-02-20', 'YYYY-MM-DD'));
INSERT INTO CLIENTE_VEHICULOS VALUES ('98765432D', 4, SYSDATE - 10, NULL);
INSERT INTO CLIENTE_VEHICULOS VALUES ('87654321E', 5, SYSDATE - 40, NULL);


INSERT INTO VEHICULOS_SERVICIOS VALUES (1, 1);
INSERT INTO VEHICULOS_SERVICIOS VALUES (2, 1);
INSERT INTO VEHICULOS_SERVICIOS VALUES (3, 2);



















